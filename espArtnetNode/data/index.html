<!DOCTYPE html>
<html lang="en">
	<head>
		<meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
		<title>
			ESP8266 ArtNetNode Config
		</title>
		<meta content='Matthew Tong - http://github.com/mtongnz/' name="DC.creator">
		<meta content='width=device-width,initial-scale=1' name="viewport">
		<link href="/style.css" rel="stylesheet">
	</head>
	<body>
		<div id="page">
			<div class="inner">
				<div class="mast">
					<div class="title">
						esp8266
						<h1>
							ArtNet & sACN
						</h1>to
						<h1>
							DMX & LED Pixels
						</h1>
					</div>
					<ul class="nav">
						<li class="first">
							<a href='javascript:menuClick(1)'>Device Status</a>
						</li>
						<li>
							<a href='javascript:menuClick(2)'>WiFi</a>
						</li>
						<li>
							<a href='javascript:menuClick(3)'>IP & Name</a>
						</li>
						<li>
							<a href='javascript:menuClick(4)'>Port A</a>
						</li>
						<!-- Remove if ONE_PORT is defined -->
						<li>
							<a href='javascript:menuClick(5)'>Port B</a>
						</li>
						<li>
							<a href='javascript:menuClick(6)'>Scenes</a>
						</li>
						<li>
							<a href='javascript:menuClick(7)'>Firmware</a>
						</li>
						<li>
							<a href='javascript:reboot()'>Reboot</a>
						</li>
						<li class="last">
							<a href='javascript:loadDebugLog()'>Debugging</a>
						</li>
					</ul>
					<div class="author">
						<i>Design by</i> Matthew Tong
					</div>
				</div>
				<div class='main section'>
					<!-- name not valid on div tags, but required by and works with getElementsByName in js -->
					<div class="hide" name="error">
						<h2>Error</h2>
						<p class="center">There was an error communicating with the device. Refresh the page and try again.</p>
					</div>
					<div class="show" name="sections">
						<h2>Fetching Data</h2>
						<p class="center">Fetching data from device. If this message is still here in 15 seconds, try refreshing the page or clicking the menu option again.</p>
					</div>

					<div class="hide" name="sections">
						<h2>Device Status</h2>
						<p class="left">Device Name:</p>
						<p class="right" name="nodeName"></p>
						<p class="left">MAC Address:</p>
						<p class="right" name="macAddress"></p>
						<p class="left">Wifi Status:</p>
						<p class="right" name="wifiStatus"></p>
						<p class="left">IP Address:</p>
						<p class="right" name="ipAddressT"></p>
						<p class="left">Subnet Address:</p>
						<p class="right" name="subAddressT"></p>
						<p class="left">Port A:</p>
						<p class="right" name="portAStatus"></p>
						<!-- Remove if ONE_PORT is defined -->
						<p class="left">Port B:</p>
						<p class="right" name="portBStatus"></p>
						<p class="left">Scene Storage:</p>
						<p class="right" name="sceneStatus"></p>
						<p class="left">Firmware:</p>
						<p class="right" name="firmwareStatus"></p>
					</div>

					<div class="hide" name="sections">
						<input name="save" type="button" value='Save Changes'>
						<h2>WiFi Settings</h2>
						<p class="left">MAC Address:</p>
						<p class="right" name="macAddress"></p>
						<p class="spacer"></p>
						<p class="left">Wifi SSID:</p>
						<p class="right"><input type="text" name="wifiSSID"></p>
						<p class="left">Password:</p>
						<p class="right"><input type="text" name="wifiPass"></p>
						<p class="spacer"></p>
						<p class="left">Hotspot SSID:</p>
						<p class="right"><input type='text' name='hotspotSSID'>May be altered for uniqueness</p>
						<p class="left">Password:</p>
						<p class="right"><input type="text" name="hotspotPass"></p>
						<p class="left">Start Delay:</p>
						<p class="right"><input name="hotspotDelay" type="number" min="0" max="180" class="number"> (seconds)</p>
						<p class="spacer"></p>
						<p class="left">Stand Alone:</p>
						<p class="right"><input name="standAloneEnable" type="checkbox" value="true"></p>
						<p class="right">In normal mode, the hotspot will start after <i>delay</i> seconds if the main WiFi won't connect. If no users connect, the device will reset and attempt the main WiFi again. This feature is purely for changing settings and ArtNet data is ignored.</p>
						<p class="right">Stand alone mode disables the primary WiFi connection and allows ArtNet data to be received via the hotspot connection.</p>
					</div>

					<div class="hide" name="sections">
						<input name="save" type="button" value='Save Changes'>
						<h2>IP & Node Name</h2>
						<p class='left'>Short Name:</p>
						<p class="right"><input type="text" name="nodeName"></p>
						<p class="left">Long Name:</p>
						<p class="right"><input type="text" name="longName"></p>
						<p class="spacer"></p>
						<p class="left">Enable DHCP:</p>
						<p class="right"><input name="dhcpEnable" type="checkbox" value="true"></p>
						<p class="left">IP Address:</p>
						<p class="right">
							<input name="ipAddress" type="number" min="0" max="255" class="number">
							<input name="ipAddress" type="number" min="0" max="255" class="number">
							<input name="ipAddress" type="number" min="0" max="255" class="number">
							<input name="ipAddress" type="number" min="0" max="255" class="number">
						</p>
						<p class="left">Subnet Address:</p>
						<p class="right">
							<input name="subAddress" type="number" min="0" max="255" class="number">
							<input name="subAddress" type="number" min="0" max="255" class="number">
							<input name="subAddress" type="number" min="0" max="255" class="number">
							<input name="subAddress" type="number" min="0" max="255" class="number">
						</p>
						<p class="left">Gateway Address:</p>
						<p class="right">
							<input name="gwAddress" type="number" min="0" max="255" class="number">
							<input name="gwAddress" type="number" min="0" max="255" class="number">
							<input name="gwAddress" type="number" min="0" max="255" class="number">
							<input name="gwAddress" type="number" min="0" max="255" class="number">
						</p>
						<p class="left">Broadcast Address:</p>
						<p class="right" name="bcAddress"></p>
						<p class="center">These settings only affect the main WiFi connection. The hotspot will always have DHCP enabled and an IP of <b>2.0.0.1</b></p>
					</div>

					<div class="hide" name="sections">
						<input name="save" type="button" value='Save Changes'>
						<h2>Port A Settings</h2>
						<p class="left">Port Type:</p>
						<p class="right">
							<select id="portAmode" class="select" name="portAmode"><!-- Options from JS --></select>
						</p>
						<p class="left">Protocol:</p>
						<p class="right">
							<select class="select" name="portAprot">
								<option value="0">Artnet v4</option>
								<option value="1">Artnet v4 with sACN DMX</option>
							</select>
						</p>
						<p class="left">Merge Mode:</p>
						<p class="right">
							<select class="select" name="portAmerge">
								<option value="0">Merge LTP</option>
								<option value="1">Merge HTP</option>
							</select>
						</p>
						<p class="left">Net:</p>
						<p class="right"><input name="portAnet" type="number" min="0" max="127" class="number"></p>
						<p class="left">Subnet:</p>
						<p class="right"><input name="portAsub" type="number" min="0" max="15" class="number"></p>
						<p class="left">Universe:</p>
						<p class="right">
							<input type="number" min="0" max="15" name="portAuni" class="number">
							<span name="portApix">
								<input type="number" min="0" max="15" name="portAuni" class="number">
								<input type="number" min="0" max="15" name="portAuni" class="number">
								<input type="number" min="0" max="15" name="portAuni" class="number">
							</span>
						</p>
						<p class="left">sACN Universe:</p>
						<p class="right">
							<input type="number" min="0" max="63999" name="portAsACNuni" class="number">
							<input type="number" min="1" max="63999" name="portAsACNuni" class="number">
							<input type="number" min="1" max="63999" name="portAsACNuni" class="number">
							<input type="number" min="1" max="63999" name="portAsACNuni" class="number">
						</p>
						<span name="DmxInBcAddrA">
							<p class="left">Broadcast Address:</p>
							<p class="right">
								<input type="number" min="0" max="255" name="dmxInBroadcast" class="number">
								<input type="number" min="0" max="255" name="dmxInBroadcast" class="number">
								<input type="number" min="0" max="255" name="dmxInBroadcast" class="number">
								<input type="number" min="0" max="255" name="dmxInBroadcast" class="number">
							</p>
						</span>
						<span name="portApix">
							<p class="left">Number of Pixels:</p>
							<p class="right"><input type="number" min="0" max="680" name="portAnumPix" class="number">680 max - 170 per universe</p>
							<p class="left">Colour Correction:</p>
							<p class="right"><input type="color" name="portAcorrection" value="#FFFFFF">See <a href="https://github.com/FastLED/FastLED/blob/master/src/color.h" target="_blank">FastLED color.h</a></p>
							<p class="left">White Balance Temperature:</p>
							<p class="right"><input type="color" name="portAtemp" value="#FFFFFF">See <a href="https://github.com/FastLED/FastLED/blob/master/src/color.h" target="_blank">FastLED color.h</a></p>
							<p class="left">Mode:</p>
							<p class="right">
								<select class="select" name="portApixMode">
									<option value="0">Pixel Mapping</option>
									<option value="1">12 Channel FX</option>
								</select>
							</p>
							<p class="left">Start Channel:</p>
							<p class="right"><input type="number" name="portApixFXstart" class="number" min="1" max="501">FX modes only</p>
						</span>
					</div>

					<div class="hide" name="sections">
						<input name="save" type="button" value='Save Changes'>
						<h2>Port B Settings</h2>
						<p class="left">Port Type:</p>
						<p class="right">
							<select id="portBmode" class="select" name="portBmode"><!-- Options from JS --></select>
						</p>
						<p class="left">Protocol:</p>
						<p class="right">
							<select class="select" name="portBprot">
								<option value="0">Artnet v4</option>
								<option value="1">Artnet v4 with sACN DMX</option>
							</select>
						</p>
						<p class="left">Merge Mode:</p>
						<p class="right">
							<select class="select" name="portBmerge">
								<option value="0">Merge LTP</option>
								<option value="1">Merge HTP</option>
							</select>
						</p>
						<p class="left">Net:</p>
						<p class="right"><input name="portBnet" type="number" min="0" max="127" class="number"></p>
						<p class="left">Subnet:</p>
						<p class="right"><input name="portBsub" type="number" min="0" max="15" class="number"></p>
						<p class="left">Universe:</p>
						<p class="right">
							<input type="number" min="0" max="15" name="portBuni" class="number">
							<span name="portBpix">
								<input type="number" min="0" max="15" name="portBuni" class="number">
								<input type="number" min="0" max="15" name="portBuni" class="number">
								<input type="number" min="0" max="15" name="portBuni" class="number">
							</span>
						</p>
						<p class="left">sACN Universe:</p>
						<p class="right">
							<input type="number" min="1" max="63999" name="portBsACNuni" class="number">
							<input type="number" min="1" max="63999" name="portBsACNuni" class="number">
							<input type="number" min="1" max="63999" name="portBsACNuni" class="number">
							<input type="number" min="1" max="63999" name="portBsACNuni" class="number">
						</p>
						<span name="portBpix"></span>
							<p class="left">Number of Pixels:</p>
							<p class="right"><input type="number" min="0" max="680" name="portBnumPix" class="number">680 max - 170 per universe</p>
							<p class="left">Colour Correction:</p>
							<p class="right"><input type="color" name="portBcorrection" value="#FFFFFF">See <a href="https://github.com/FastLED/FastLED/blob/master/src/color.h" target="_blank">FastLED color.h</a></p>
							<p class="left">White Temperature:</p>
							<p class="right"><input type="color" name="portBtemp" value="#FFFFFF">See <a href="https://github.com/FastLED/FastLED/blob/master/src/color.h" target="_blank">FastLED color.h</a></p>
							<p class="left">Mode:</p>
							<p class="right">
								<select class="select" name="portBpixMode">
									<option value="0">Pixel Mapping</option>
									<option value="1">12 Channel FX</option>
								</select>
							</p>
							<p class="left">Start Channel:</p>
							<p class="right">
								<input type="number" name="portBpixFXstart" class="number" min="1" max="501">FX modes only
							</p>
						</span>
					</div>

					<div class="hide" name="sections">
						<h2>
							Stored Scenes
						</h2>
						<p class="center">
							Not yet implemented
						</p>
					</div>

					<div class="hide" name="sections">
						<form action="/update" enctype="multipart/form-data" method="post" id="firmForm" name="firmForm">
							<h2>Update Firmware</h2>
							<p class="left">Firmware:</p>
							<p class="right" name="firmwareStatus"></p>
							<p class="right">
								<input name="update" type="file" id="update">
								<label for="update">
									<svg height="17" viewbox='0 0 20 17' width="20" xmlns="http://www.w3.org/2000/svg">
									<path d='M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z'>
									</path></svg>
									<span>Choose Firmware</span>
								</label>
							</p>
							<p class="right" id="uploadMsg"></p>
							<p class="right">
								<input type="button" class="submit" value='Upload Now' id="fUp">
							</p>
						</form>
					</div>

					<div id='section_debug' class='hide' name='sections'>
						<input name='save' type='button' value='Clear Log'>
						<h2>Debugging</h2>
						<p class='left'>Log:</p>
						<p class='right'><textarea id='debugLog' name='debugLog' cols='70' rows='40'></textarea></p>
						<input name="debugLogClear" type="checkbox" checked style="display:none;">
					</div>
				</div>

				<div class="footer">
					<p>Coding and hardware © 2016-2023 <a href="http://github.com/mtongnz/" target="_blank">Matthew Tong</a> &amp; <a href="http://github.com/casesolved-co-uk/" target="_blank">Richard Case</a>.</p>
					<p>Released under <a href="http://www.gnu.org/licenses/">GNU General Public License V3</a>.</p>
				</div>
			</div>
		</div>
		<script src="/main.js"></script>
	</body>
</html>
